<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1, user-scalable=no, initial-scale=1.0">
  <script src="https://gvssmark.github.io/HAMSA/harivamsa0.json"></script>
  <script src="https://gvssmark.github.io/HAMSA/harivamsa.json"></script>
  <style>
    body {
      margin: 0;
      padding-top: 115px; /* space for fixed header */
      font-family: sans-serif;
    }
    #header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: #f8f8f8;
      padding: 1px;
      border-bottom: 1px solid #ccc;
      z-index: 1000;
      text-align: center;
    }
    #searchInput {
      width: 80%;
      padding: 5px;
      font-size: 16px;
      margin-top: 0px;
    }
    #cardList {
      padding: 10px;
    }
    .card {
      padding: 4px;
      border-radius: 15px;
      border: 1px solid black;
      margin-bottom: 10px;
      white-space: pre-wrap;
      font-size: small;
      max-width: 400px;
      margin: 0 auto 10px auto;
    }
    .sender {
      color: red;
      font-size: large;
    }
    .datetime {
      color: blue;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div id="header">
    <h2>హరివంశసత్సంగము</h2>
    <input type="text" id="searchInput" placeholder="Search messages..." oninput="filterCards()">
  </div>
  <div id="cardList"></div>

  <script>
    harivamsa0.shift();
    harivamsa.shift();
    const test = [...harivamsa0, ...harivamsa];
    harivamsa = test.map(([date, time, name, message]) => ({ date, time, name, message }))
                    .filter(a => a.message.length > 0);

    function generatereport(filtered = harivamsa) {
      const list = document.getElementById("cardList");
      list.innerHTML = "";
      filtered.forEach(row => {
        let card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<span class='sender'>${row.name || ""}</span> - <span class='datetime'>${row.date}-${row.time}</span>
${row.message}`;
        list.appendChild(card);
      });
    }

    function filterCards() {
  const query = document.getElementById("searchInput").value.toLowerCase();
  const cards = document.querySelectorAll(".card");

  cards.forEach(card => {
    const text = card.textContent.toLowerCase();
    card.style.display = text.includes(query) ? "block" : "none";
  });
  window.scroll(0,0)
}
    generatereport();

    function ddmmyy(input) {
      const date = new Date(input);
      return isNaN(date.getTime()) ? '' : date.toLocaleString("en-GB", { timeZone: "Asia/Kolkata" }).substring(0, 10);
    }
  </script>
</body>
</html>
